<!-- ============================================================== -->
<!-- End Bread crumb and right sidebar toggle -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- Start Page Content -->
<!-- ============================================================== -->
<div class="row" *ngIf="currentUser">
    <div class="col-12">
        <div class="card m-b-0">
            <!-- .chat-row -->
            <div class="chat-main-box">
                <!-- .chat-left-panel -->
                <div class="chat-left-aside">
                    <div class="open-panel"><i class="ti-angle-right"></i></div>
                    <div class="chat-left-inner">
                        <div class="form-material">
                            <input class="form-control p-20" type="text" placeholder="Search Contact">
                        </div>
                        <ul class="chatonline style-none ">
                            <li *ngFor="let chat of chats | async">
                                <div *ngIf="chat.user1 === currentUser.uid" (click)="selectedChat(chat)">
                                    <a href="javascript:void(0)"><img [src]="(chat.user2 | user | async)?.photoURL"
                                                                      alt="user-img"
                                                                      class="img-circle"> <span>{{ (chat.user2 | user | async)?.displayName }}
                                        <small>{{chat.lastMessage }}</small>
                                        <small class="text-success">{{chat.updatedDt | amTimeAgo }}</small>
                                    </span></a>
                                </div>
                                <div *ngIf="chat.user2 === currentUser.uid" (click)="selectedChat(chat)">
                                    <a href="javascript:void(0)">
                                        <img [src]="(chat.user1 | user | async)?.photoURL" alt="user-img"
                                             class="img-circle"/>
                                        <span>{{ (chat.user1 | user | async)?.displayName }}
                                            <small>{{chat.lastMessage }}</small>
                                            <small class="text-success">{{ chat.updatedDt | amTimeAgo }}</small>
                                        </span>
                                    </a>
                                </div>
                            </li>
                            <li class="p-20"></li>
                        </ul>
                    </div>
                </div>
                <!-- .chat-left-panel -->
                <!-- .chat-right-panel -->
                <div class="chat-right-aside">
                    <div class="chat-main-header">
                        <div class="p-20 b-b">
                            <h3 class="box-title">Chat Message</h3>
                        </div>
                    </div>
                    <div class="chat-rbox">
                        <ul class="chat-list p-20" *ngIf="currentChat">
                            <div *ngFor="let message of (currentChat.id | chat | async)?.messages">
                                <li *ngIf="message.user != currentUser.uid">
                                    <div class="chat-img"><img [src]="(message.user | user | async)?.photoURL"
                                                               alt="user"/></div>
                                    <div class="chat-content">
                                        <h5>{{(message.user | user | async)?.displayName}}</h5>
                                        <div class="box bg-light-info">{{message.value}}</div>
                                    </div>
                                    <div class="chat-time">{{message.updatedDt | amDateFormat: 'HH:mm A' }}</div>
                                </li>
                                <li class="reverse" *ngIf="message.user == currentUser.uid">
                                    <div class="chat-time">{{message.updatedDt | amDateFormat: 'HH:mm A' }}</div>
                                    <div class="chat-content">
                                        <h5>{{(message.user | user | async)?.displayName}}</h5>
                                        <div class="box bg-light-inverse">{{message.value}}</div>
                                    </div>
                                    <div class="chat-img"><img [src]="(message.user | user | async)?.photoURL"
                                                               alt="user"/></div>
                                </li>
                            </div>
                        </ul>
                    </div>
                    <div class="card-body b-t">
                        <div class="row">
                            <div class="col-8">
                                <input placeholder="Type your message here" class="form-control b-0"
                                       [(ngModel)]="message"/>
                            </div>
                            <div class="col-4 text-right">
                                <button type="button" class="btn btn-info btn-circle btn-lg" (click)="sendMessage()"><i
                                        class="fa fa-paper-plane-o"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- .chat-right-panel -->
            </div>
            <!-- /.chat-row -->
        </div>
    </div>
</div>